<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Magic Eggs - –£—Ö–æ–¥ –∏ –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 400px;
            margin: 0 auto;
            text-align: center;
        }
        
        .egg-container {
            margin: 20px 0;
            position: relative;
        }
        
        .egg {
            width: 150px;
            height: 150px;
            margin: 0 auto;
            border-radius: 50%;
            background: linear-gradient(45deg, #f8f8f8, #e8e8e8);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 60px;
            border: 5px solid gold;
            box-shadow: 0 0 20px rgba(255,215,0,0.5);
            transition: all 0.3s;
        }
        
        .gold-egg { background: linear-gradient(45deg, #FFD700, #FFA500); }
        .diamond-egg { background: linear-gradient(45deg, #00FFFF, #0080FF); }
        
        .stats {
            background: rgba(255, 255, 255, 0.2);
            padding: 15px;
            border-radius: 15px;
            margin: 15px 0;
            backdrop-filter: blur(10px);
        }
        
        .stat-item {
            margin: 8px 0;
            font-size: 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255,255,255,0.3);
            border-radius: 4px;
            margin: 5px 0;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: #FFD700;
            transition: width 0.5s;
        }
        
        .care-actions {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin: 10px 0;
        }
        
        .main-actions {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin: 15px 0;
        }
        
        button {
            background: linear-gradient(45deg, #FFD700, #FFA500);
            border: none;
            padding: 15px;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            color: #333;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 215, 0, 0.4);
        }
        
        .inventory-btn {
            background: linear-gradient(45deg, #4ECDC4, #44A08D);
            grid-column: span 2;
        }
        
        .shop-btn {
            background: linear-gradient(45deg, #FF6B6B, #FF8E53);
        }
        
        .care-btn {
            background: linear-gradient(45deg, #FFB6C1, #FF69B4);
            font-size: 14px;
            padding: 12px;
        }
        
        .timer {
            background: rgba(255,255,255,0.1);
            padding: 10px;
            border-radius: 10px;
            margin: 10px 0;
            font-size: 14px;
        }
        
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        
        .modal-content {
            background: linear-gradient(135deg, #667eea, #764ba2);
            padding: 20px;
            border-radius: 20px;
            max-width: 350px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .egg-shop {
            display: grid;
            gap: 10px;
            margin: 15px 0;
        }
        
        .shop-item {
            background: rgba(255,255,255,0.2);
            padding: 15px;
            border-radius: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .inventory-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin: 15px 0;
        }
        
        .inventory-item {
            background: rgba(255,255,255,0.2);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .inventory-item:hover {
            transform: scale(1.05);
            background: rgba(255,255,255,0.3);
        }
        
        .item-common { border: 2px solid #FFFFFF; }
        .item-rare { border: 2px solid #FFD700; }
        .item-epic { border: 2px solid #FF6B6B; }
        .item-legendary { border: 2px solid #00FFFF; }
        
        .hidden {
            display: none;
        }
        
        .rarity-badge {
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 8px;
            margin-left: 5px;
        }
        
        .common { background: #666; }
        .rare { background: #FFD700; color: black; }
        .epic { background: #FF6B6B; }
        .legendary { background: #00FFFF; color: black; }
        
        .payment-info {
            background: rgba(255,255,255,0.1);
            padding: 10px;
            border-radius: 10px;
            margin: 10px 0;
            font-size: 12px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéÅ Magic Eggs</h1>
        
        <div class="egg-container">
            <div id="currentEgg" class="egg">ü•ö</div>
            <div id="timer" class="timer hidden">
                –î–æ –≤—ã–ª—É–ø–ª–µ–Ω–∏—è: <span id="countdown">72:00:00</span>
            </div>
        </div>
        
        <div class="stats">
            <div class="stat-item">
                <span>üçñ –°—ã—Ç–æ—Å—Ç—å:</span>
                <span>
                    <div class="progress-bar">
                        <div id="hunger-bar" class="progress-fill" style="width: 50%;"></div>
                    </div>
                    <span id="hunger">50</span>/100
                </span>
            </div>
            
            <div class="stat-item">
                <span>üòä –ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ:</span>
                <span>
                    <div class="progress-bar">
                        <div id="mood-bar" class="progress-fill" style="width: 50%;"></div>
                    </div>
                    <span id="mood">50</span>/100
                </span>
            </div>
            
            <div class="stat-item">
                <span>üí∞ –ó–≤—ë–∑–¥—ã:</span>
                <span id="stars">0</span>
            </div>
            
            <div class="stat-item">
                <span>üì¶ –ü—Ä–µ–¥–º–µ—Ç—ã:</span>
                <span id="itemCount">0</span>
            </div>
            
            <div class="stat-item">
                <span>üéØ –¢–µ–∫—É—â–µ–µ —è–π—Ü–æ:</span>
                <span id="eggType">–û–±—ã—á–Ω–æ–µ</span>
            </div>
        </div>
        
        <!-- –ö–Ω–æ–ø–∫–∏ —É—Ö–æ–¥–∞ –∑–∞ —è–π—Ü–æ–º -->
        <div class="care-actions">
            <button onclick="feedEgg()" class="care-btn">üçñ –ü–æ–∫–æ—Ä–º–∏—Ç—å</button>
            <button onclick="playWithEgg()" class="care-btn">üéæ –ü–æ–∏–≥—Ä–∞—Ç—å</button>
        </div>
        
        <!-- –û—Å–Ω–æ–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ -->
        <div class="main-actions">
            <button onclick="openShop()" class="shop-btn">üõçÔ∏è –ú–∞–≥–∞–∑–∏–Ω</button>
            <button onclick="openInventory()" class="inventory-btn">üì¶ –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</button>
        </div>

        <div class="payment-info">
            üí´ –î–ª—è –ø–æ–∫—É–ø–æ–∫ –Ω—É–∂–Ω—ã Telegram Stars<br>
            –ü–æ–ª—É—á–∞–π—Ç–µ –∑–≤—ë–∑–¥—ã –æ—Ç –¥—Ä—É–∑–µ–π –∏–ª–∏ –ø–æ–∫—É–ø–∞–π—Ç–µ –≤ Telegram
        </div>
    </div>

    <!-- –ú–∞–≥–∞–∑–∏–Ω -->
    <div id="shopModal" class="modal hidden">
        <div class="modal-content">
            <h2>üõçÔ∏è –ú–∞–≥–∞–∑–∏–Ω –Ø–∏—Ü</h2>
            <div class="egg-shop">
                <div class="shop-item">
                    <div>
                        <div>ü•ö –û–±—ã—á–Ω–æ–µ —è–π—Ü–æ</div>
                        <div class="rarity-badge common">–û–±—ã—á–Ω–æ–µ</div>
                    </div>
                    <button onclick="initiatePayment('common', 50)">50 ‚≠ê</button>
                </div>
                <div class="shop-item">
                    <div>
                        <div>ü•ö –ó–æ–ª–æ—Ç–æ–µ —è–π—Ü–æ</div>
                        <div class="rarity-badge rare">–†–µ–¥–∫–æ–µ</div>
                    </div>
                    <button onclick="initiatePayment('rare', 170)">170 ‚≠ê</button>
                </div>
                <div class="shop-item">
                    <div>
                        <div>ü•ö –ê–ª–º–∞–∑–Ω–æ–µ —è–π—Ü–æ</div>
                        <div class="rarity-badge legendary">–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–æ–µ</div>
                    </div>
                    <button onclick="initiatePayment('legendary', 250)">250 ‚≠ê</button>
                </div>
            </div>
            <div class="payment-info">
                üí∞ –û–ø–ª–∞—Ç–∞ —á–µ—Ä–µ–∑ Telegram Stars<br>
                ‚≠ê –ó–≤—ë–∑–¥—ã —Å–ø–∏—Å—ã–≤–∞—é—Ç—Å—è —Å –≤–∞—à–µ–≥–æ –±–∞–ª–∞–Ω—Å–∞
            </div>
            <button onclick="closeShop()" style="width:100%; margin-top:10px;">‚ùå –ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

    <!-- –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å -->
    <div id="inventoryModal" class="modal hidden">
        <div class="modal-content">
            <h2>üì¶ –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</h2>
            <div id="inventoryGrid" class="inventory-grid">
                <!-- –ü—Ä–µ–¥–º–µ—Ç—ã –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
            </div>
            <button onclick="closeInventory()" style="width:100%; margin-top:10px;">‚ùå –ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

    <!-- –í—ã–ª—É–ø–ª–µ–Ω–∏–µ -->
    <div id="hatchModal" class="modal hidden">
        <div class="modal-content">
            <h2>üéâ –í—ã–ª—É–ø–ª–µ–Ω–∏–µ!</h2>
            <div id="hatchResult" style="font-size: 60px; margin: 20px 0;"></div>
            <div id="hatchText" style="margin: 15px 0;"></div>
            <button onclick="closeHatch()" style="width:100%;">üéä –ó–∞–±—Ä–∞—Ç—å!</button>
        </div>
    </div>

    <!-- –û–∫–Ω–æ –æ–ø–ª–∞—Ç—ã -->
    <div id="paymentModal" class="modal hidden">
        <div class="modal-content">
            <h2>üí´ –û–ø–ª–∞—Ç–∞</h2>
            <div id="paymentText" style="margin: 15px 0; font-size: 18px;"></div>
            <div class="payment-info">
                ‚úÖ –û–ø–ª–∞—Ç–∞ —á–µ—Ä–µ–∑ Telegram Stars<br>
                üí∞ –°—É–º–º–∞: <span id="paymentAmount">0</span> ‚≠ê<br>
                üéÅ –¢–æ–≤–∞—Ä: <span id="paymentItem">–Ø–π—Ü–æ</span>
            </div>
            <div style="display: grid; gap: 10px; margin-top: 15px;">
                <button onclick="processPayment()" style="background: linear-gradient(45deg, #4CAF50, #45a049);">
                    üí≥ –û–ø–ª–∞—Ç–∏—Ç—å —Å–µ–π—á–∞—Å
                </button>
                <button onclick="closePayment()" style="background: linear-gradient(45deg, #ff4757, #ff3742);">
                    ‚ùå –û—Ç–º–µ–Ω–∞
                </button>
            </div>
        </div>
    </div>

    <script>
        // –°–∏—Å—Ç–µ–º–∞ –ø—Ä–µ–¥–º–µ—Ç–æ–≤
        const ITEMS = {
            'heart': { emoji: '‚ù§Ô∏è', name: '–°–µ—Ä–¥–µ—á–∫–æ', rarity: 'common', value: 15 },
            'cake': { emoji: 'üéÇ', name: '–¢–æ—Ä—Ç–∏–∫', rarity: 'common', value: 15 },
            'diamond': { emoji: 'üíé', name: '–ê–ª–º–∞–∑', rarity: 'rare', value: 50 },
            'trophy': { emoji: 'üèÜ', name: '–¢—Ä–æ—Ñ–µ–π', rarity: 'epic', value: 100 },
            'crown': { emoji: 'üëë', name: '–ö–æ—Ä–æ–Ω–∞', rarity: 'legendary', value: 250 }
        };

        // –®–∞–Ω—Å—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ —è–∏—Ü
        const EGG_CHANCES = {
            'common': [
                { item: 'heart', chance: 50 },
                { item: 'cake', chance: 50 }
            ],
            'rare': [
                { item: 'heart', chance: 30 },
                { item: 'cake', chance: 30 },
                { item: 'diamond', chance: 40 }
            ],
            'legendary': [
                { item: 'diamond', chance: 40 },
                { item: 'trophy', chance: 35 },
                { item: 'crown', chance: 25 }
            ]
        };

        // –î–∞–Ω–Ω—ã–µ –∏–≥—Ä—ã
        let gameData = {
            stars: 0, // –ù–∞—á–∏–Ω–∞–µ–º —Å 0 –∑–≤—ë–∑–¥!
            inventory: [],
            currentEgg: null,
            eggStartTime: null,
            hunger: 50,
            mood: 50,
            lastAction: Date.now()
        };

        // –¢–µ–∫—É—â–∞—è –ø–æ–∫—É–ø–∫–∞
        let pendingPurchase = null;

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
        function loadGame() {
            const saved = localStorage.getItem('magicEggs_save');
            if (saved) {
                const savedData = JSON.parse(saved);
                Object.assign(gameData, savedData);
            }
            updateDisplay();
            checkEggHatch();
            startAutoDecrease();
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–≥—Ä—ã
        function saveGame() {
            gameData.lastAction = Date.now();
            localStorage.setItem('magicEggs_save', JSON.stringify(gameData));
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        function updateDisplay() {
            document.getElementById('stars').textContent = gameData.stars;
            document.getElementById('itemCount').textContent = gameData.inventory.length;
            document.getElementById('hunger').textContent = gameData.hunger;
            document.getElementById('mood').textContent = gameData.mood;
            
            document.getElementById('hunger-bar').style.width = gameData.hunger + '%';
            document.getElementById('mood-bar').style.width = gameData.mood + '%';
            
            if (gameData.currentEgg) {
                document.getElementById('eggType').textContent = getEggName(gameData.currentEgg.type);
                document.getElementById('timer').classList.remove('hidden');
                document.getElementById('currentEgg').className = `egg ${gameData.currentEgg.type}-egg`;
            } else {
                document.getElementById('eggType').textContent = '–ù–µ—Ç';
                document.getElementById('timer').classList.add('hidden');
                document.getElementById('currentEgg').className = 'egg';
            }
        }

        // –ò–Ω–∏—Ü–∏–∞—Ü–∏—è –æ–ø–ª–∞—Ç—ã
        function initiatePayment(eggType, price) {
            pendingPurchase = { type: eggType, price: price };
            
            document.getElementById('paymentAmount').textContent = price;
            document.getElementById('paymentItem').textContent = getEggName(eggType);
            document.getElementById('paymentText').innerHTML = `
                –í—ã –ø–æ–∫—É–ø–∞–µ—Ç–µ:<br>
                <strong>${getEggName(eggType)} —è–π—Ü–æ</strong><br>
                –∑–∞ <strong>${price} ‚≠ê</strong>
            `;
            
            document.getElementById('paymentModal').classList.remove('hidden');
            closeShop();
        }

        // –ü—Ä–æ—Ü–µ—Å—Å –æ–ø–ª–∞—Ç—ã (–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram Stars)
        function processPayment() {
            if (!pendingPurchase) return;
            
            const eggType = pendingPurchase.type;
            const price = pendingPurchase.price;
            
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –≤—ã–∑–æ–≤ Telegram Payments API
            // –î–ª—è –¥–µ–º–æ –ø—Ä–æ—Å—Ç–æ —Å–ø–∏—Å—ã–≤–∞–µ–º –∑–≤—ë–∑–¥—ã
            if (gameData.stars >= price) {
                // –£—Å–ø–µ—à–Ω–∞—è –æ–ø–ª–∞—Ç–∞
                gameData.stars -= price;
                buyEgg(eggType);
                showMessage(`‚úÖ –û–ø–ª–∞—Ç–∞ –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ! –ü—Ä–∏–æ–±—Ä–µ—Ç–µ–Ω–æ ${getEggName(eggType)} —è–π—Ü–æ.`);
            } else {
                // –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–≤—ë–∑–¥
                showMessage(`‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–≤—ë–∑–¥! –ù—É–∂–Ω–æ ${price} ‚≠ê, —É –≤–∞—Å ${gameData.stars} ‚≠ê`);
            }
            
            closePayment();
            pendingPurchase = null;
        }

        function closePayment() {
            document.getElementById('paymentModal').classList.add('hidden');
            pendingPurchase = null;
        }

        // –ü–æ–∫—É–ø–∫–∞ —è–π—Ü–∞ (–ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç—ã)
        function buyEgg(type) {
            if (gameData.currentEgg) {
                alert('‚ùå –£ –≤–∞—Å —É–∂–µ –µ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–æ–µ —è–π—Ü–æ!');
                return;
            }
            
            gameData.currentEgg = {
                type: type,
                startTime: Date.now()
            };
            
            updateDisplay();
            startEggTimer();
            saveGame();
            alert(`üéâ –í—ã –ø—Ä–∏–æ–±—Ä–µ–ª–∏ ${getEggName(type)} —è–π—Ü–æ!`);
        }

        // –£—Ö–æ–¥ –∑–∞ —è–π—Ü–æ–º
        function feedEgg() {
            if (gameData.hunger < 100) {
                gameData.hunger = Math.min(gameData.hunger + 10, 100);
                updateDisplay();
                animateEgg();
                showMessage('–Ø–π—Ü–æ –ø–æ–∫–æ—Ä–º–ª–µ–Ω–æ! +10 –∫ —Å—ã—Ç–æ—Å—Ç–∏');
                saveGame();
            } else {
                showMessage('–Ø–π—Ü–æ —É–∂–µ —Å—ã—Ç–æ!');
            }
        }

        function playWithEgg() {
            if (gameData.mood < 100) {
                gameData.mood = Math.min(gameData.mood + 10, 100);
                gameData.hunger = Math.max(gameData.hunger - 5, 0);
                updateDisplay();
                animateEgg();
                showMessage('–ü–æ–∏–≥—Ä–∞–ª–∏ —Å —è–π—Ü–æ–º! +10 –∫ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—é');
                saveGame();
            } else {
                showMessage('–Ø–π—Ü–æ —É–∂–µ –¥–æ–≤–æ–ª—å–Ω–æ!');
            }
        }

        // –ê–Ω–∏–º–∞—Ü–∏—è —è–π—Ü–∞
        function animateEgg() {
            const eggElement = document.getElementById('currentEgg');
            eggElement.style.transform = 'scale(1.1)';
            setTimeout(() => {
                eggElement.style.transform = 'scale(1)';
            }, 200);
        }

        // –ê–≤—Ç–æ-—É–º–µ–Ω—å—à–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
        function startAutoDecrease() {
            setInterval(() => {
                if (gameData.hunger > 0) gameData.hunger -= 1;
                if (gameData.mood > 0) gameData.mood -= 1;
                updateDisplay();
                saveGame();
            }, 60000); // –ö–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
        }

        // –¢–∞–π–º–µ—Ä —è–π—Ü–∞ (3 –¥–Ω—è)
        function startEggTimer() {
            updateEggTimer();
            setInterval(updateEggTimer, 1000);
        }

        function updateEggTimer() {
            if (!gameData.currentEgg) return;
            
            const hatchTime = gameData.currentEgg.startTime + (3 * 24 * 60 * 60 * 1000); // 3 –¥–Ω—è
            const now = Date.now();
            const timeLeft = hatchTime - now;
            
            if (timeLeft <= 0) {
                hatchEgg();
                return;
            }
            
            const hours = Math.floor(timeLeft / (1000 * 60 * 60));
            const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
            
            document.getElementById('countdown').textContent = 
                `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–ª—É–ø–ª–µ–Ω–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        function checkEggHatch() {
            if (gameData.currentEgg) {
                const hatchTime = gameData.currentEgg.startTime + (3 * 24 * 60 * 60 * 1000);
                if (Date.now() >= hatchTime) {
                    hatchEgg();
                } else {
                    startEggTimer();
                }
            }
        }

        // –í—ã–ª—É–ø–ª–µ–Ω–∏–µ
        function hatchEgg() {
            const eggType = gameData.currentEgg.type;
            const chances = EGG_CHANCES[eggType];
            
            // –í—ã–±–æ—Ä –ø—Ä–µ–¥–º–µ—Ç–∞ –ø–æ —à–∞–Ω—Å–∞–º
            const random = Math.random() * 100;
            let currentChance = 0;
            let selectedItem = 'heart';
            
            for (const chance of chances) {
                currentChance += chance.chance;
                if (random <= currentChance) {
                    selectedItem = chance.item;
                    break;
                }
            }
            
            const item = ITEMS[selectedItem];
            
            // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å
            gameData.inventory.push({
                id: Date.now(),
                type: selectedItem,
                emoji: item.emoji,
                name: item.name,
                rarity: item.rarity,
                value: item.value
            });
            
            // –ü–æ–∫–∞–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
            document.getElementById('hatchResult').textContent = item.emoji;
            document.getElementById('hatchText').innerHTML = `
                –ü–æ–ª—É—á–µ–Ω: ${item.name}<br>
                –†–µ–¥–∫–æ—Å—Ç—å: <span class="rarity-badge ${item.rarity}">${getRarityName(item.rarity)}</span><br>
                –°—Ç–æ–∏–º–æ—Å—Ç—å: ${item.value} ‚≠ê
            `;
            
            document.getElementById('hatchModal').classList.remove('hidden');
            
            // –û—á–∏—Å—Ç–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ —è–π—Ü–∞
            gameData.currentEgg = null;
            updateDisplay();
            saveGame();
        }

        // –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å
        function openInventory() {
            const grid = document.getElementById('inventoryGrid');
            grid.innerHTML = '';
            
            if (gameData.inventory.length === 0) {
                grid.innerHTML = '<div style="grid-column: span 3; padding: 20px;">üì≠ –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –ø—É—Å—Ç</div>';
            } else {
                gameData.inventory.forEach(item => {
                    const itemElement = document.createElement('div');
                    itemElement.className = `inventory-item item-${item.rarity}`;
                    itemElement.innerHTML = `
                        <div style="font-size: 30px;">${item.emoji}</div>
                        <div style="font-size: 12px; margin-top: 5px;">${item.name}</div>
                        <div style="font-size: 10px; opacity: 0.8;">${item.value} ‚≠ê</div>
                    `;
                    itemElement.onclick = () => withdrawItem(item.id);
                    grid.appendChild(itemElement);
                });
            }
            
            document.getElementById('inventoryModal').classList.remove('hidden');
        }

        // –í—ã–≤–æ–¥ –ø—Ä–µ–¥–º–µ—Ç–∞
        function withdrawItem(itemId) {
            if (confirm('üí∏ –í—ã–≤–µ—Å—Ç–∏ —ç—Ç–æ—Ç –ø—Ä–µ–¥–º–µ—Ç –≤ –∑–≤—ë–∑–¥—ã?')) {
                const itemIndex = gameData.inventory.findIndex(item => item.id === itemId);
                if (itemIndex !== -1) {
                    const item = gameData.inventory[itemIndex];
                    gameData.stars += item.value;
                    gameData.inventory.splice(itemIndex, 1);
                    
                    updateDisplay();
                    saveGame();
                    openInventory(); // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å
                    alert(`‚úÖ –ü—Ä–µ–¥–º–µ—Ç –≤—ã–≤–µ–¥–µ–Ω! +${item.value} ‚≠ê`);
                }
            }
        }

        // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        function getEggName(type) {
            const names = { common: '–û–±—ã—á–Ω–æ–µ', rare: '–ó–æ–ª–æ—Ç–æ–µ', legendary: '–ê–ª–º–∞–∑–Ω–æ–µ' };
            return names[type];
        }

        function getRarityName(rarity) {
            const names = { common: '–û–±—ã—á–Ω–∞—è', rare: '–†–µ–¥–∫–∞—è', epic: '–≠–ø–∏—á–µ—Å–∫–∞—è', legendary: '–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è' };
            return names[rarity];
        }

        function showMessage(text) {
            alert(text);
        }

        // –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞
        function openShop() {
            document.getElementById('shopModal').classList.remove('hidden');
        }

        function closeShop() {
            document.getElementById('shopModal').classList.add('hidden');
        }

        function openInventory() {
            document.getElementById('inventoryModal').classList.remove('hidden');
        }

        function closeInventory() {
            document.getElementById('inventoryModal').classList.add('hidden');
        }

        function closeHatch() {
            document.getElementById('hatchModal').classList.add('hidden');
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram
        if (window.Telegram && window.Telegram.WebApp) {
            Telegram.WebApp.expand();
            Telegram.WebApp.ready();
            
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–ª–∞—Ç–µ–∂–µ–π
            // Telegram.WebApp.enableClosingConfirmation();
            // Telegram.WebApp.MainButton.setText('–û–ø–ª–∞—Ç–∏—Ç—å').show().onClick(processPayment);
        }

        // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã
        loadGame();
    </script>
</body>
</html>
