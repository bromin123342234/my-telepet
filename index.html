<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ü•ö NFT Duck Eggs | –ö–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–Ω—ã–µ —É—Ç–∫–∏</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary: #8B5FBF;
            --primary-dark: #6B46C1;
            --primary-light: #9D7BCF;
            --secondary: #FF6B6B;
            --secondary-dark: #FF4757;
            --accent: #4ECDC4;
            --accent-dark: #1DD1A1;
            --gold: #FFD700;
            --gold-dark: #FFA500;
            --dark: #0F0F1E;
            --darker: #0A0A15;
            --dark-card: #1A1A2E;
            --light: #F8F9FA;
            --success: #27AE60;
            --success-dark: #219A52;
            --danger: #E74C3C;
            --warning: #F39C12;
            --purple-glow: rgba(139, 95, 191, 0.3);
            --gold-glow: rgba(255, 215, 0, 0.3);
            --success-glow: rgba(39, 174, 96, 0.3);
        }

        body {
            background: linear-gradient(135deg, var(--dark) 0%, var(--darker) 100%);
            min-height: 100vh;
            padding: 20px;
            color: var(--light);
            display: flex;
            justify-content: center;
            align-items: center;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(139, 95, 191, 0.15) 0%, transparent 25%),
                radial-gradient(circle at 90% 80%, rgba(78, 205, 196, 0.15) 0%, transparent 25%),
                radial-gradient(circle at 50% 50%, rgba(255, 107, 107, 0.1) 0%, transparent 30%);
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 30%, rgba(139, 95, 191, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(78, 205, 196, 0.1) 0%, transparent 50%);
            pointer-events: none;
            z-index: -1;
        }

        .game-container {
            background: linear-gradient(145deg, rgba(26, 26, 46, 0.9), rgba(22, 33, 62, 0.9));
            backdrop-filter: blur(20px);
            border-radius: 30px;
            padding: 35px 30px;
            box-shadow: 
                0 25px 50px rgba(0, 0, 0, 0.5),
                0 0 0 1px rgba(255, 255, 255, 0.08),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            max-width: 450px;
            width: 100%;
            text-align: center;
            position: relative;
            border: 1px solid rgba(255, 255, 255, 0.08);
            animation: fadeInUp 0.8s ease-out;
        }

        @keyframes fadeInUp {
            from { 
                opacity: 0; 
                transform: translateY(30px);
            }
            to { 
                opacity: 1; 
                transform: translateY(0);
            }
        }

        .container-glow {
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, var(--primary), var(--accent), var(--gold));
            border-radius: 32px;
            z-index: -1;
            opacity: 0.3;
            filter: blur(15px);
            animation: glowPulse 4s ease-in-out infinite;
        }

        @keyframes glowPulse {
            0%, 100% { opacity: 0.2; }
            50% { opacity: 0.4; }
        }

        .player-id {
            position: absolute;
            top: 20px;
            left: 20px;
            background: linear-gradient(135deg, var(--gold), var(--gold-dark));
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 700;
            color: var(--dark);
            box-shadow: 0 6px 20px var(--gold-glow);
            border: 1px solid rgba(255, 255, 255, 0.3);
            z-index: 10;
        }

        .header {
            margin-bottom: 30px;
            margin-top: 15px;
            position: relative;
        }

        .header h1 {
            font-size: 2.8em;
            margin-bottom: 15px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 50%, var(--gold) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 4px 20px var(--purple-glow);
            font-weight: 800;
            letter-spacing: -0.5px;
        }

        .egg-display {
            margin: 30px 0;
            position: relative;
            padding: 25px;
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.08), rgba(255, 255, 255, 0.03));
            border-radius: 25px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            box-shadow: 
                inset 0 2px 4px rgba(255, 255, 255, 0.05),
                0 8px 25px rgba(0, 0, 0, 0.3);
        }

        .duck-frame {
            position: relative;
            width: 160px;
            height: 160px;
            margin: 0 auto 20px auto;
            border-radius: 50%;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
            padding: 8px;
            box-shadow: 
                0 10px 30px rgba(0, 0, 0, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .duck-image {
            width: 140px;
            height: 140px;
            object-fit: contain;
            border-radius: 50%;
        }

        .egg-type {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            padding: 12px 25px;
            border-radius: 25px;
            font-weight: 700;
            margin-top: 15px;
            display: inline-block;
            box-shadow: 0 6px 20px var(--purple-glow);
            border: 1px solid rgba(255, 255, 255, 0.2);
            font-size: 14px;
        }

        .death-message {
            color: var(--danger);
            font-weight: 700;
            margin: 15px 0;
            text-shadow: 0 2px 15px rgba(231, 76, 60, 0.4);
            font-size: 16px;
            padding: 15px;
            background: rgba(231, 76, 60, 0.1);
            border-radius: 15px;
            border: 1px solid rgba(231, 76, 60, 0.3);
        }

        .food-count {
            background: linear-gradient(135deg, var(--success), var(--success-dark));
            color: white;
            padding: 15px 25px;
            border-radius: 20px;
            margin: 20px 0;
            font-weight: 700;
            box-shadow: 0 8px 25px var(--success-glow);
            border: 1px solid rgba(255, 255, 255, 0.2);
            font-size: 15px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 18px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
            color: white;
            padding: 25px 20px;
            border-radius: 20px;
            text-align: center;
            position: relative;
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            box-shadow: 
                0 6px 20px rgba(0, 0, 0, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 
                0 12px 30px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--primary), var(--accent));
            border-radius: 20px 20px 0 0;
        }

        .stat-icon {
            font-size: 1.5em;
            margin-bottom: 8px;
            display: block;
        }

        .stat-value {
            font-size: 1.9em;
            font-weight: 800;
            margin-top: 5px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            background: linear-gradient(135deg, var(--light), #ccc);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .stat-progress {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            height: 8px;
            margin-top: 10px;
            overflow: hidden;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .hunger-progress {
            background: linear-gradient(135deg, var(--success), var(--success-dark));
            height: 100%;
            border-radius: 12px;
            transition: width 0.5s ease;
            box-shadow: 0 2px 8px rgba(39, 174, 96, 0.4);
        }

        .mood-progress {
            background: linear-gradient(135deg, var(--accent), var(--accent-dark));
            height: 100%;
            border-radius: 12px;
            transition: width 0.5s ease;
            box-shadow: 0 2px 8px rgba(78, 205, 196, 0.4);
        }

        .stars-display {
            color: var(--gold);
            text-shadow: 0 0 15px var(--gold-glow);
        }

        .actions-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 18px;
            margin-bottom: 25px;
        }

        .btn {
            padding: 20px;
            border: none;
            border-radius: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.15);
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
        }

        .btn-secondary {
            background: linear-gradient(135deg, var(--secondary), var(--secondary-dark));
            color: white;
        }

        .btn-admin {
            background: linear-gradient(135deg, var(--gold), var(--gold-dark));
            color: var(--dark);
            font-weight: 800;
            margin: 20px 0;
            width: 100%;
            padding: 18px;
            box-shadow: 0 6px 20px var(--gold-glow);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.4);
        }

        .menu-section {
            margin-top: 30px;
        }

        .menu-btn {
            background: linear-gradient(135deg, var(--accent), var(--accent-dark));
            color: white;
            padding: 20px;
            border: none;
            border-radius: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            box-shadow: 0 6px 20px rgba(78, 205, 196, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.15);
        }

        .menu-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(78, 205, 196, 0.5);
        }

        .info-text {
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.08), rgba(255, 255, 255, 0.03));
            padding: 20px;
            border-radius: 18px;
            margin-top: 25px;
            font-size: 14px;
            color: #ccc;
            line-height: 1.5;
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
        }

        .balance-info {
            background: linear-gradient(135deg, var(--gold), var(--gold-dark));
            color: var(--dark);
            padding: 18px 25px;
            border-radius: 20px;
            margin: 20px 0;
            font-weight: 700;
            font-size: 14px;
            text-align: center;
            box-shadow: 0 6px 20px var(--gold-glow);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .admin-panel {
            background: linear-gradient(145deg, rgba(26, 26, 46, 0.95), rgba(22, 33, 62, 0.95));
            border-radius: 25px;
            padding: 30px;
            margin-top: 25px;
            color: white;
            display: none;
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            box-shadow: 
                0 15px 35px rgba(0, 0, 0, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .admin-panel.active {
            display: block;
            animation: slideDown 0.4s ease-out;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-15px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .admin-controls {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .admin-input {
            padding: 14px 18px;
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 14px;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .admin-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(139, 95, 191, 0.3);
            background: rgba(255, 255, 255, 0.15);
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--danger), #C0392B);
            color: white;
            margin-top: 15px;
        }

        .admin-header {
            text-align: center;
            margin-bottom: 25px;
            color: var(--gold);
            font-size: 1.4em;
            text-shadow: 0 2px 15px var(--gold-glow);
            font-weight: 700;
        }

        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(10px);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: linear-gradient(145deg, rgba(26, 26, 46, 0.98), rgba(22, 33, 62, 0.98));
            backdrop-filter: blur(25px);
            border-radius: 30px;
            padding: 35px;
            max-width: 520px;
            width: 90%;
            max-height: 85vh;
            overflow-y: auto;
            position: relative;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 
                0 25px 50px rgba(0, 0, 0, 0.6),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            animation: scaleIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes scaleIn {
            from { opacity: 0; transform: scale(0.8); }
            to { opacity: 1; transform: scale(1); }
        }

        .modal-header {
            text-align: center;
            margin-bottom: 25px;
            color: var(--light);
            font-size: 1.8em;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .shop-item {
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.08), rgba(255, 255, 255, 0.03));
            padding: 25px;
            border-radius: 20px;
            margin: 18px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .shop-item:hover {
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.12), rgba(255, 255, 255, 0.06));
            transform: translateY(-3px);
        }

        .inventory-item {
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.08), rgba(255, 255, 255, 0.03));
            padding: 22px;
            border-radius: 18px;
            margin: 12px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .inventory-item:hover {
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.12), rgba(255, 255, 255, 0.06));
            transform: translateY(-2px);
        }

        .quest-item {
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.08), rgba(255, 255, 255, 0.03));
            padding: 25px;
            border-radius: 20px;
            margin: 15px 0;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .close-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background: var(--danger);
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(231, 76, 60, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .close-btn:hover {
            transform: rotate(90deg) scale(1.1);
            background: #C0392B;
        }

        .confirm-buttons {
            display: flex;
            gap: 15px;
            margin-top: 25px;
            justify-content: center;
        }

        .empty-inventory {
            text-align: center;
            padding: 50px 30px;
            color: #999;
        }

        .withdraw-btn {
            background: linear-gradient(135deg, var(--success), var(--success-dark));
            color: white;
            padding: 12px 22px;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px var(--success-glow);
            border: 1px solid rgba(255, 255, 255, 0.2);
            font-weight: 600;
        }

        .withdraw-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px var(--success-glow);
        }

        .quest-btn {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            padding: 12px 22px;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px var(--purple-glow);
            border: 1px solid rgba(255, 255, 255, 0.2);
            font-weight: 600;
        }

        .quest-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px var(--purple-glow);
        }

        .notification {
            position: fixed;
            top: 25px;
            right: 25px;
            padding: 18px 28px;
            background: linear-gradient(135deg, var(--success), var(--success-dark));
            color: white;
            border-radius: 18px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.5);
            z-index: 10000;
            opacity: 0;
            transform: translateX(100px);
            transition: all 0.4s ease;
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            font-weight: 600;
            max-width: 350px;
        }

        .notification.show {
            opacity: 1;
            transform: translateX(0);
        }

        .withdraw-request-item {
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.08), rgba(255, 255, 255, 0.03));
            padding: 15px;
            border-radius: 15px;
            margin: 10px 0;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .loading {
            color: #ccc;
            text-align: center;
            padding: 20px;
        }

        @media (max-width: 480px) {
            .game-container {
                padding: 25px 20px;
                margin: 10px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .actions-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .header h1 {
                font-size: 2.2em;
            }
            
            .duck-frame {
                width: 140px;
                height: 140px;
            }
            
            .duck-image {
                width: 120px;
                height: 120px;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="container-glow"></div>
        
        <div class="player-id">ID: <span id="playerId">–ó–∞–≥—Ä—É–∑–∫–∞...</span></div>
        
        <div class="header">
            <h1>ü¶Ü NFT Ducks</h1>
            <div class="egg-display">
                <div class="duck-frame" id="duckDisplay">
                    <img src="https://i.ibb.co/6W3s8y0/duck-default.png" alt="–ù–µ—Ç —É—Ç–∫–∏" class="duck-image" id="duckImage">
                </div>
                <div class="egg-type" id="eggTypeDisplay">–ù–µ—Ç —É—Ç–∫–∏</div>
                <div id="deathMessage" class="death-message" style="display: none;">üíÄ –£—Ç–∫–∞ —É–º–µ—Ä–ª–∞! –ö—É–ø–∏—Ç–µ –Ω–æ–≤—É—é</div>
            </div>
        </div>
        
        <div class="food-count" id="foodCount">üçé –ï–¥—ã: 0</div>
        
        <div class="stats-grid">
            <div class="stat-card">
                <span class="stat-icon">üçΩÔ∏è</span>
                <div>–°—ã—Ç–æ—Å—Ç—å</div>
                <div class="stat-value" id="hungerValue">0/100</div>
                <div class="stat-progress">
                    <div class="hunger-progress" id="hungerProgress" style="width: 0%;"></div>
                </div>
            </div>
            <div class="stat-card">
                <span class="stat-icon">üòä</span>
                <div>–ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ</div>
                <div class="stat-value" id="moodValue">0/100</div>
                <div class="stat-progress">
                    <div class="mood-progress" id="moodProgress" style="width: 0%;"></div>
                </div>
            </div>
            <div class="stat-card">
                <span class="stat-icon">‚≠ê</span>
                <div>–ó–≤—ë–∑–¥—ã</div>
                <div class="stat-value stars-display" id="starsValue">0</div>
            </div>
            <div class="stat-card">
                <span class="stat-icon">üéí</span>
                <div>–ü—Ä–µ–¥–º–µ—Ç—ã</div>
                <div class="stat-value" id="itemsValue">0</div>
            </div>
        </div>
        
        <div class="actions-grid">
            <button class="btn btn-primary" onclick="feedDuck()">
                <span>üçé</span>
                <span>–ü–æ–∫–æ—Ä–º–∏—Ç—å</span>
            </button>
            <button class="btn btn-secondary" onclick="playWithDuck()">
                <span>üéÆ</span>
                <span>–ü–æ–∏–≥—Ä–∞—Ç—å</span>
            </button>
        </div>

        <button class="btn btn-admin" id="adminToggle" onclick="toggleAdminPanel()" style="display: none;">
            <span>üîß</span>
            <span>–ê–¥–º–∏–Ω –ü–∞–Ω–µ–ª—å</span>
        </button>
        
        <div class="menu-section">
            <button class="menu-btn" onclick="openShop()">
                <span>üõí</span>
                <span>–ú–∞–≥–∞–∑–∏–Ω</span>
            </button>
            <button class="menu-btn" onclick="openInventory()">
                <span>üéí</span>
                <span>–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</span>
            </button>
            <button class="menu-btn" onclick="openQuests()">
                <span>üéØ</span>
                <span>–ó–∞–¥–∞–Ω–∏—è</span>
            </button>
            <button class="menu-btn" onclick="openReferral()">
                <span>üë•</span>
                <span>–†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞</span>
            </button>
        </div>

        <div class="balance-info">
            üíé –ß—Ç–æ–±—ã –ø–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å, –ø–æ–¥–∞—Ä–∏—Ç–µ –ø–æ–¥–∞—Ä–æ–∫ –Ω–∞ –∞–∫–∫–∞—É–Ω—Ç @NFT_c0llecti0n
        </div>

        <div class="info-text">
            <strong>üéÆ –£—Ö–∞–∂–∏–≤–∞–π—Ç–µ –∑–∞ —É—Ç–∫–æ–π!</strong><br>
            –ö–æ—Ä–º–∏—Ç–µ –∏ –∏–≥—Ä–∞–π—Ç–µ —Å —É—Ç–∫–æ–π, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ NFT-–ø—Ä–µ–¥–º–µ—Ç—ã
        </div>

        <div class="admin-panel" id="adminPanel">
            <div class="admin-controls">
                <div class="admin-header">üîß –ê–¥–º–∏–Ω –ü–∞–Ω–µ–ª—å</div>
                
                <input type="text" class="admin-input" placeholder="ID –∏–≥—Ä–æ–∫–∞" id="adminPlayerId">
                <input type="number" class="admin-input" placeholder="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–≤—ë–∑–¥" id="adminStars">
                
                <button class="btn btn-admin" onclick="adminGiveStars()">‚úÖ –í—ã–¥–∞—Ç—å –∑–≤—ë–∑–¥—ã</button>
                
                <div class="admin-header" style="margin-top: 25px;">üéØ –í—Å–µ –∏–≥—Ä–æ–∫–∏</div>
                <button class="btn btn-primary" onclick="loadAllPlayers()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫</button>
                <div id="allPlayers" class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –∏–≥—Ä–æ–∫–æ–≤...</div>
                
                <button class="btn btn-danger" onclick="adminReset()">üîÑ –°–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å</button>
                
                <div class="admin-header" style="margin-top: 25px;">üìä –ó–∞—è–≤–∫–∏ –Ω–∞ –≤—ã–≤–æ–¥</div>
                <button class="btn btn-primary" onclick="loadWithdrawRequests()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å –∑–∞—è–≤–∫–∏</button>
                <div id="withdrawRequests" class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞—è–≤–æ–∫...</div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->
    <div class="modal" id="shopModal">
        <div class="modal-content">
            <button class="close-btn" onclick="closeShop()">√ó</button>
            <h2 class="modal-header">üõí –ú–∞–≥–∞–∑–∏–Ω</h2>
            
            <div class="shop-item">
                <div>
                    <strong>‚ú® –ó–æ–ª–æ—Ç–∞—è —É—Ç–∫–∞</strong><br>
                    <small>–®–∞–Ω—Å—ã: –®–∞–º–ø–∞–Ω—Å–∫–æ–µ 50%, –ö–∞–ª–µ–Ω–¥–∞—Ä–∏–∫ 25%, Tama Gadget 20%, Evil Eye 10%, Love Potion 5%</small>
                </div>
                <button class="btn btn-primary" onclick="buyItem('gold_egg', 300)">300 ‚≠ê</button>
            </div>
            
            <div class="shop-item">
                <div>
                    <strong>üçé –ï–¥–∞ (3 —à—Ç)</strong><br>
                    <small>–ü–æ–ø–æ–ª–Ω–∏—Ç–µ –∑–∞–ø–∞—Å –µ–¥—ã –¥–ª—è –∫–æ—Ä–º–ª–µ–Ω–∏—è</small>
                </div>
                <button class="btn btn-primary" onclick="buyItem('food', 15)">15 ‚≠ê</button>
            </div>
            
            <div class="shop-item">
                <div>
                    <strong>ü¶Ü –û–±—ã—á–Ω–∞—è —É—Ç–∫–∞</strong><br>
                    <small>–®–∞–Ω—Å—ã: –ú–∏—à–∫–∞ 50%, –†–æ–∑–∞ 25%, –ö–∞–ª–µ–Ω–¥–∞—Ä–∏–∫ 5%</small>
                </div>
                <button class="btn btn-primary" onclick="buyItem('normal_egg', 50)">50 ‚≠ê</button>
            </div>
        </div>
    </div>

    <div class="modal" id="confirmModal">
        <div class="modal-content">
            <h3>–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–æ–∫—É–ø–∫–∏</h3>
            <p id="confirmText">–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –∫—É–ø–∏—Ç—å —ç—Ç–æ—Ç –ø—Ä–µ–¥–º–µ—Ç?</p>
            <div class="confirm-buttons">
                <button class="btn btn-secondary" onclick="closeConfirm()">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-primary" onclick="confirmPurchase()">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <div class="modal" id="inventoryModal">
        <div class="modal-content">
            <button class="close-btn" onclick="closeInventory()">√ó</button>
            <h2 class="modal-header">üéí –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</h2>
            <div id="inventoryItems"></div>
        </div>
    </div>

    <div class="modal" id="withdrawModal">
        <div class="modal-content">
            <button class="close-btn" onclick="closeWithdraw()">√ó</button>
            <h2 class="modal-header">üì§ –ó–∞—è–≤–∫–∞ –Ω–∞ –≤—ã–≤–æ–¥</h2>
            <div class="info-text">
                <p>–í—ã —Ö–æ—Ç–∏—Ç–µ –≤—ã–≤–µ—Å—Ç–∏ –ø—Ä–µ–¥–º–µ—Ç: <strong id="withdrawItemName"></strong></p>
                <p>–ù–∞–ø–∏—à–∏—Ç–µ –≤–∞—à Telegram username –¥–ª—è —Å–≤—è–∑–∏:</p>
                <input type="text" class="admin-input" id="telegramUsername" placeholder="@username">
                <button class="btn btn-primary" style="width: 100%; margin-top: 20px;" onclick="submitWithdraw()">‚úÖ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É</button>
            </div>
        </div>
    </div>

    <div class="modal" id="questsModal">
        <div class="modal-content">
            <button class="close-btn" onclick="closeQuests()">√ó</button>
            <h2 class="modal-header">üéØ –ó–∞–¥–∞–Ω–∏—è</h2>
            <div class="quest-item">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                    <strong>üì¢ –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∫–∞–Ω–∞–ª</strong>
                    <button class="quest-btn" onclick="claimQuest()">üéÅ –ü–æ–ª—É—á–∏—Ç—å 10‚≠ê</button>
                </div>
                <p>–ü–æ–¥–ø–∏—à–∏—Ç–µ—Å—å –Ω–∞ –Ω–∞—à Telegram –∫–∞–Ω–∞–ª @MyNFTPet</p>
                <div style="display: flex; align-items: center; gap: 8px; margin-top: 12px; font-size: 14px; color: var(--gold); font-weight: 600;">
                    üéÅ –ù–∞–≥—Ä–∞–¥–∞: 10 ‚≠ê –ó–≤—ë–∑–¥—ã
                </div>
            </div>
        </div>
    </div>

    <div class="modal" id="referralModal">
        <div class="modal-content">
            <button class="close-btn" onclick="closeReferral()">√ó</button>
            <h2 class="modal-header">üë• –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞</h2>
            <div class="info-text">
                <p style="text-align: center; color: var(--warning); font-weight: bold;">
                    ‚ö†Ô∏è –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –≤—Ä–µ–º–µ–Ω–Ω–æ –∑–∞–∫—Ä—ã—Ç–∞
                </p>
            </div>
        </div>
    </div>
    
    <div class="notification" id="notification"></div>

    <script>
        // –ö–û–ù–°–¢–ê–ù–¢–´
        const ADMIN_USER_ID = "USER_1761399526979_swpx4n20o";
        const DUCK_IMAGES = {
            normal: "https://i.ibb.co/xtn9FC2N/normal-duck.png",
            gold: "https://i.ibb.co/B5czcMk3/gold-duck.png", 
            dead: "https://i.ibb.co/6W3s8y0/duck-default.png",
            none: "https://i.ibb.co/6W3s8y0/duck-default.png"
        };

        // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø SUPABASE
        const supabaseUrl = 'https://ovnukmhlpjuirmlijvqq.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im92bnVrbWhscGp1aXJtbGlqdnFxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE1Njc0NDMsImV4cCI6MjA3NzE0MzQ0M30.t0sNQiamZE5pbdptekj742d8zMexLst5LOI6b0yQ_Cw';
        
        const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);

        // –î–ê–ù–ù–´–ï –ò–ì–†–û–ö–ê
        let playerData = {
            id: '',
            hunger: 100,
            mood: 100,
            stars: 0,
            items: [],
            currentEgg: null,
            foodCount: 3,
            isAlive: false,
            lastStatDecrease: Date.now()
        };

        let currentPurchase = null;
        let currentWithdrawItem = null;

        // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ò–ì–†–´
        async function initGame() {
            console.log("üéÆ –ò–≥—Ä–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...");
            
            // –°—Ä–∞–∑—É —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º ID –∏–∑ localStorage –∏–ª–∏ —Å–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π
            await setupPlayerId();
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–≥—Ä–æ–∫–∞ –∏–∑ –±–∞–∑—ã
            await loadPlayerData();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            updateUI();
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º —Å–∏—Å—Ç–µ–º—É —É–º–µ–Ω—å—à–µ–Ω–∏—è –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π
            startStatDecrease();
            
            showNotification('üéâ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! –í—ã –ø–æ–ª—É—á–∏–ª–∏ 3 –µ–¥–∏–Ω–∏—Ü—ã –µ–¥—ã!');
        }

        // –ù–ê–°–¢–†–û–ô–ö–ê ID –ò–ì–†–û–ö–ê
        async function setupPlayerId() {
            let playerId = localStorage.getItem('playerId');
            
            if (!playerId) {
                // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π ID
                playerId = 'USER_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                localStorage.setItem('playerId', playerId);
                
                // –°–æ–∑–¥–∞–µ–º –∏–≥—Ä–æ–∫–∞ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
                await createPlayerInDatabase(playerId);
            }
            
            playerData.id = playerId;
            document.getElementById('playerId').textContent = playerData.id;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–¥–º–∏–Ω–∞
            if (playerData.id === ADMIN_USER_ID) {
                document.getElementById('adminToggle').style.display = 'block';
                showNotification('üëë –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, –ê–¥–º–∏–Ω!');
            }
        }

        // –°–û–ó–î–ê–ù–ò–ï –ò–ì–†–û–ö–ê –í –ë–ê–ó–ï –î–ê–ù–ù–´–•
        async function createPlayerInDatabase(playerId) {
            try {
                const newPlayerData = {
                    id: playerId,
                    hunger: 100,
                    mood: 100,
                    stars: 0,
                    items: [],
                    currentEgg: null,
                    foodCount: 3,
                    isAlive: false,
                    lastStatDecrease: Date.now(),
                    created_at: new Date().toISOString()
                };

                const { data, error } = await supabase
                    .from('players')
                    .insert([newPlayerData]);

                if (error) throw error;
                console.log("‚úÖ –ò–≥—Ä–æ–∫ —Å–æ–∑–¥–∞–Ω –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö:", playerId);
            } catch (error) {
                console.error("‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∏–≥—Ä–æ–∫–∞ –≤ –±–∞–∑–µ:", error);
            }
        }

        // –ó–ê–ì–†–£–ó–ö–ê –î–ê–ù–ù–´–• –ò–ì–†–û–ö–ê –ò–ó –ë–ê–ó–´
        async function loadPlayerData() {
            try {
                const { data, error } = await supabase
                    .from('players')
                    .select('*')
                    .eq('id', playerData.id)
                    .single();

                if (error) throw error;

                if (data) {
                    Object.assign(playerData, data);
                    console.log("‚úÖ –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ –±–∞–∑—ã:", playerData);
                } else {
                    console.log("‚ùå –ò–≥—Ä–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –±–∞–∑–µ, —Å–æ–∑–¥–∞–µ–º...");
                    await createPlayerInDatabase(playerData.id);
                }
            } catch (error) {
                console.error("‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –±–∞–∑—ã:", error);
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∫–∞–∫ –∑–∞–ø–∞—Å–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç
                loadFromLocalStorage();
            }
        }

        // –ó–ê–ì–†–£–ó–ö–ê –ò–ó LOCALSTORAGE (–ó–ê–ü–ê–°–ù–û–ô –í–ê–†–ò–ê–ù–¢)
        function loadFromLocalStorage() {
            const savedData = localStorage.getItem('playerData_' + playerData.id);
            
            if (savedData) {
                try {
                    const data = JSON.parse(savedData);
                    Object.assign(playerData, data);
                    console.log("‚úÖ –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ localStorage:", playerData);
                } catch (error) {
                    console.log("‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö, –∏—Å–ø–æ–ª—å–∑—É–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è");
                    setInitialData();
                }
            } else {
                setInitialData();
            }
        }

        // –£–°–¢–ê–ù–û–í–ö–ê –ù–ê–ß–ê–õ–¨–ù–´–• –î–ê–ù–ù–´–•
        function setInitialData() {
            playerData.hunger = 100;
            playerData.mood = 100;
            playerData.foodCount = 3;
            playerData.stars = 0;
            playerData.items = [];
            playerData.currentEgg = null;
            playerData.isAlive = false;
            playerData.lastStatDecrease = Date.now();
            savePlayerData();
        }

        // –°–û–•–†–ê–ù–ï–ù–ò–ï –î–ê–ù–ù–´–• –ò–ì–†–û–ö–ê –í –ë–ê–ó–£
        async function savePlayerData() {
            try {
                const { data, error } = await supabase
                    .from('players')
                    .upsert([playerData]);

                if (error) throw error;
                console.log("üíæ –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ –±–∞–∑—É:", playerData);
                
                // –¢–∞–∫–∂–µ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage –∫–∞–∫ backup
                localStorage.setItem('playerData_' + playerData.id, JSON.stringify(playerData));
            } catch (error) {
                console.error("‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –±–∞–∑—É, –∏—Å–ø–æ–ª—å–∑—É–µ–º localStorage:", error);
                localStorage.setItem('playerData_' + playerData.id, JSON.stringify(playerData));
            }
        }

        // –ó–ê–ì–†–£–ó–ö–ê –í–°–ï–• –ò–ì–†–û–ö–û–í
        async function loadAllPlayers() {
            try {
                const { data, error } = await supabase
                    .from('players')
                    .select('id, stars, items, currentEgg, isAlive')
                    .order('created_at', { ascending: false });

                if (error) throw error;

                const playersContainer = document.getElementById('allPlayers');
                
                if (data.length === 0) {
                    playersContainer.innerHTML = '<div class="info-text">–ù–µ—Ç –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∏–≥—Ä–æ–∫–æ–≤</div>';
                    return;
                }

                let html = '';
                data.forEach(player => {
                    const eggType = player.currentEgg ? 
                        (player.currentEgg.type === 'gold_egg' ? '‚ú® –ó–æ–ª–æ—Ç–∞—è' : 'ü¶Ü –û–±—ã—á–Ω–∞—è') : 
                        '‚ùå –ù–µ—Ç —É—Ç–∫–∏';
                    
                    html += `
                        <div class="withdraw-request-item">
                            <strong>ID:</strong> ${player.id}<br>
                            <strong>–ó–≤—ë–∑–¥—ã:</strong> ${player.stars} ‚≠ê<br>
                            <strong>–£—Ç–∫–∞:</strong> ${eggType}<br>
                            <strong>–ü—Ä–µ–¥–º–µ—Ç—ã:</strong> ${player.items.length} —à—Ç<br>
                            <strong>–°—Ç–∞—Ç—É—Å:</strong> ${player.isAlive ? 'üü¢ –ñ–∏–≤–∞' : 'üî¥ –ú–µ—Ä—Ç–≤–∞'}
                        </div>
                    `;
                });
                
                playersContainer.innerHTML = html;
                showNotification('‚úÖ –°–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤ –æ–±–Ω–æ–≤–ª–µ–Ω!');
            } catch (error) {
                console.error("‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–≥—Ä–æ–∫–æ–≤:", error);
                document.getElementById('allPlayers').innerHTML = '<div class="info-text">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–≥—Ä–æ–∫–æ–≤</div>';
            }
        }

        // –ó–ê–ì–†–£–ó–ö–ê –ó–ê–Ø–í–û–ö –ù–ê –í–´–í–û–î
        async function loadWithdrawRequests() {
            try {
                const { data, error } = await supabase
                    .from('withdraw_requests')
                    .select('*')
                    .order('created_at', { ascending: false });

                if (error) throw error;

                const requestsContainer = document.getElementById('withdrawRequests');
                
                if (!data || data.length === 0) {
                    requestsContainer.innerHTML = '<div class="info-text">–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞—è–≤–æ–∫ –Ω–∞ –≤—ã–≤–æ–¥</div>';
                    return;
                }

                let html = '';
                data.forEach((request, index) => {
                    html += `
                        <div class="withdraw-request-item">
                            <strong>–ò–≥—Ä–æ–∫:</strong> ${request.player_id}<br>
                            <strong>–ü—Ä–µ–¥–º–µ—Ç:</strong> ${request.item_name}<br>
                            <strong>Telegram:</strong> ${request.telegram}<br>
                            <strong>–í—Ä–µ–º—è:</strong> ${new Date(request.created_at).toLocaleString()}
                            <button class="btn btn-danger" style="margin-top: 10px; padding: 8px 16px;" onclick="completeWithdraw('${request.id}')">
                                ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ
                            </button>
                        </div>
                    `;
                });
                
                requestsContainer.innerHTML = html;
                showNotification('‚úÖ –ó–∞—è–≤–∫–∏ –Ω–∞ –≤—ã–≤–æ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω—ã!');
            } catch (error) {
                console.error("‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞—è–≤–æ–∫:", error);
                document.getElementById('withdrawRequests').innerHTML = '<div class="info-text">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞—è–≤–æ–∫</div>';
            }
        }

        // –°–ò–°–¢–ï–ú–ê –£–ú–ï–ù–¨–®–ï–ù–ò–Ø –ü–û–ö–ê–ó–ê–¢–ï–õ–ï–ô
        function startStatDecrease() {
            setInterval(() => {
                if (!playerData.isAlive) return;
                
                const now = Date.now();
                const minutesPassed = (now - playerData.lastStatDecrease) / (1000 * 60);
                
                if (minutesPassed >= 1) {
                    playerData.hunger = Math.max(0, playerData.hunger - 1);
                    playerData.mood = Math.max(0, playerData.mood - 2);
                    playerData.lastStatDecrease = now;
                    
                    savePlayerData();
                    updateUI();
                    checkDeath();
                }
            }, 60000);
        }

        // –û–ë–ù–û–í–õ–ï–ù–ò–ï –ò–ù–¢–ï–†–§–ï–ô–°–ê
        function updateUI() {
            document.getElementById('hungerValue').textContent = playerData.hunger + '/100';
            document.getElementById('moodValue').textContent = playerData.mood + '/100';
            document.getElementById('starsValue').textContent = playerData.stars;
            document.getElementById('itemsValue').textContent = playerData.items.length;
            document.getElementById('foodCount').textContent = 'üçé –ï–¥—ã: ' + playerData.foodCount;

            document.getElementById('hungerProgress').style.width = playerData.hunger + '%';
            document.getElementById('moodProgress').style.width = playerData.mood + '%';

            const duckImage = document.getElementById('duckImage');
            const eggTypeDisplay = document.getElementById('eggTypeDisplay');
            const deathMessage = document.getElementById('deathMessage');

            if (!playerData.isAlive) {
                duckImage.src = DUCK_IMAGES.dead;
                duckImage.alt = "–£—Ç–∫–∞ —É–º–µ—Ä–ª–∞";
                eggTypeDisplay.textContent = '–£—Ç–∫–∞ —É–º–µ—Ä–ª–∞';
                eggTypeDisplay.style.background = 'linear-gradient(135deg, #666, #333)';
                deathMessage.style.display = 'block';
            } else if (playerData.currentEgg) {
                if (playerData.currentEgg.type === 'gold_egg') {
                    duckImage.src = DUCK_IMAGES.gold;
                    duckImage.alt = "–ó–æ–ª–æ—Ç–∞—è —É—Ç–∫–∞";
                    eggTypeDisplay.textContent = '–ó–æ–ª–æ—Ç–∞—è —É—Ç–∫–∞';
                    eggTypeDisplay.style.background = 'linear-gradient(135deg, var(--gold), var(--gold-dark))';
                } else {
                    duckImage.src = DUCK_IMAGES.normal;
                    duckImage.alt = "–û–±—ã—á–Ω–∞—è —É—Ç–∫–∞";
                    eggTypeDisplay.textContent = '–û–±—ã—á–Ω–∞—è —É—Ç–∫–∞';
                    eggTypeDisplay.style.background = 'linear-gradient(135deg, var(--primary), var(--primary-dark))';
                }
                deathMessage.style.display = 'none';
            } else {
                duckImage.src = DUCK_IMAGES.none;
                duckImage.alt = "–ù–µ—Ç —É—Ç–∫–∏";
                eggTypeDisplay.textContent = '–ù–µ—Ç —É—Ç–∫–∏';
                eggTypeDisplay.style.background = 'linear-gradient(135deg, var(--primary), var(--primary-dark))';
                deathMessage.style.display = 'none';
            }
        }

        // –£–•–û–î –ó–ê –£–¢–ö–û–ô
        async function feedDuck() {
            if (!playerData.isAlive) {
                showNotification('‚ùå –£—Ç–∫–∞ —É–º–µ—Ä–ª–∞! –ö—É–ø–∏—Ç–µ –Ω–æ–≤—É—é —É—Ç–∫—É.');
                return;
            }
            if (playerData.foodCount <= 0) {
                showNotification('‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –µ–¥—ã! –ö—É–ø–∏—Ç–µ –µ–¥—É –≤ –º–∞–≥–∞–∑–∏–Ω–µ.');
                return;
            }
            playerData.hunger = Math.min(100, playerData.hunger + 14);
            playerData.foodCount--;
            await savePlayerData();
            updateUI();
            showNotification('üçé –£—Ç–∫–∞ –ø–æ–∫–æ—Ä–º–ª–µ–Ω–∞! +14 –∫ —Å—ã—Ç–æ—Å—Ç–∏');
            checkDeath();
        }

        async function playWithDuck() {
            if (!playerData.isAlive) {
                showNotification('‚ùå –£—Ç–∫–∞ —É–º–µ—Ä–ª–∞! –ö—É–ø–∏—Ç–µ –Ω–æ–≤—É—é —É—Ç–∫—É.');
                return;
            }
            playerData.mood = Math.min(100, playerData.mood + 10);
            await savePlayerData();
            updateUI();
            showNotification('üéÆ –í—ã –ø–æ–∏–≥—Ä–∞–ª–∏ —Å —É—Ç–∫–æ–π! +10 –∫ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—é');
        }

        function checkDeath() {
            if ((playerData.hunger <= 0 || playerData.mood <= 0) && playerData.isAlive) {
                playerData.isAlive = false;
                playerData.currentEgg = null;
                savePlayerData();
                updateUI();
                showNotification('üíÄ –£—Ç–∫–∞ —É–º–µ—Ä–ª–∞ –æ—Ç –≥–æ–ª–æ–¥–∞ –∏–ª–∏ –ø–ª–æ—Ö–æ–≥–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è! –ö—É–ø–∏—Ç–µ –Ω–æ–≤—É—é —É—Ç–∫—É.');
            }
        }

        // –ú–ê–ì–ê–ó–ò–ù
        function openShop() {
            document.getElementById('shopModal').classList.add('active');
        }

        function closeShop() {
            document.getElementById('shopModal').classList.remove('active');
        }

        function buyItem(itemType, cost) {
            currentPurchase = { itemType, cost };
            const itemNames = {
                'gold_egg': '–ó–æ–ª–æ—Ç—É—é —É—Ç–∫—É',
                'normal_egg': '–û–±—ã—á–Ω—É—é —É—Ç–∫—É', 
                'food': '3 –µ–¥–∏–Ω–∏—Ü—ã –µ–¥—ã'
            };
            document.getElementById('confirmText').textContent = `–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –∫—É–ø–∏—Ç—å ${itemNames[itemType]} –∑–∞ ${cost} –∑–≤—ë–∑–¥?`;
            document.getElementById('confirmModal').classList.add('active');
        }

        function closeConfirm() {
            document.getElementById('confirmModal').classList.remove('active');
        }

        async function confirmPurchase() {
            if (!currentPurchase) return;
            
            const { itemType, cost } = currentPurchase;
            
            if (playerData.stars < cost) {
                showNotification('‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–≤—ë–∑–¥!');
                closeConfirm();
                return;
            }
            
            playerData.stars -= cost;
            
            if (itemType === 'food') {
                playerData.foodCount += 3;
                showNotification('üéâ –í—ã –∫—É–ø–∏–ª–∏ 3 –µ–¥–∏–Ω–∏—Ü—ã –µ–¥—ã!');
            } else {
                playerData.currentEgg = { type: itemType };
                playerData.isAlive = true;
                playerData.hunger = 100;
                playerData.mood = 100;
                showNotification('üéâ –í—ã –∫—É–ø–∏–ª–∏ —É—Ç–∫—É! –£—Ö–∞–∂–∏–≤–∞–π—Ç–µ –∑–∞ –Ω–µ–π.');
            }
            
            await savePlayerData();
            updateUI();
            closeConfirm();
            closeShop();
        }

        // –ò–ù–í–ï–ù–¢–ê–†–¨ –ò –í–´–í–û–î
        function openInventory() {
            const inventoryItems = document.getElementById('inventoryItems');
            
            if (playerData.items.length === 0) {
                inventoryItems.innerHTML = `
                    <div class="empty-inventory">
                        <h3>üéí –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –ø—É—Å—Ç</h3>
                        <p>–í—ã–ª—É–ø–∏—Ç–µ —è–π—Ü–æ, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–µ–¥–º–µ—Ç—ã!</p>
                    </div>
                `;
            } else {
                let html = '';
                playerData.items.forEach((item, index) => {
                    html += `
                        <div class="inventory-item">
                            <div>
                                <strong>${item.name}</strong><br>
                                <small>–ò–∑: ${item.type === 'gold_egg' ? '–ó–æ–ª–æ—Ç–æ–π —É—Ç–∫–∏' : '–û–±—ã—á–Ω–æ–π —É—Ç–∫–∏'}</small>
                            </div>
                            <button class="withdraw-btn" onclick="startWithdraw(${index})">üì§ –í—ã–≤–æ–¥</button>
                        </div>
                    `;
                });
                inventoryItems.innerHTML = html;
            }
            
            document.getElementById('inventoryModal').classList.add('active');
        }

        function closeInventory() {
            document.getElementById('inventoryModal').classList.remove('active');
        }

        function startWithdraw(itemIndex) {
            currentWithdrawItem = itemIndex;
            const item = playerData.items[itemIndex];
            document.getElementById('withdrawItemName').textContent = item.name;
            document.getElementById('telegramUsername').value = '';
            document.getElementById('withdrawModal').classList.add('active');
        }

        function closeWithdraw() {
            document.getElementById('withdrawModal').classList.remove('active');
        }

        async function submitWithdraw() {
            const telegram = document.getElementById('telegramUsername').value.trim();
            if (!telegram) {
                showNotification('‚ùå –í–≤–µ–¥–∏—Ç–µ Telegram username!');
                return;
            }

            if (!telegram.startsWith('@')) {
                showNotification('‚ùå Telegram username –¥–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å @!');
                return;
            }

            const item = playerData.items[currentWithdrawItem];
            
            // –°–æ–∑–¥–∞–µ–º –∑–∞—è–≤–∫—É –Ω–∞ –≤—ã–≤–æ–¥ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
            try {
                const withdrawRequest = {
                    player_id: playerData.id,
                    item_name: item.name,
                    telegram: telegram,
                    created_at: new Date().toISOString()
                };

                const { data, error } = await supabase
                    .from('withdraw_requests')
                    .insert([withdrawRequest]);

                if (error) throw error;

                // –£–¥–∞–ª—è–µ–º –ø—Ä–µ–¥–º–µ—Ç –∏–∑ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
                playerData.items.splice(currentWithdrawItem, 1);
                await savePlayerData();
                updateUI();
                
                closeWithdraw();
                closeInventory();
                showNotification('‚úÖ –ó–∞—è–≤–∫–∞ –Ω–∞ –≤—ã–≤–æ–¥ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞! –° –≤–∞–º–∏ —Å–≤—è–∂—É—Ç—Å—è –≤ Telegram.');
            } catch (error) {
                console.error("‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞—è–≤–∫–∏:", error);
                showNotification('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –∑–∞—è–≤–∫–∏!');
            }
        }

        // –í–´–ü–û–õ–ù–ï–ù–ò–ï –ó–ê–Ø–í–ö–ò –ù–ê –í–´–í–û–î
        async function completeWithdraw(requestId) {
            try {
                const { data, error } = await supabase
                    .from('withdraw_requests')
                    .delete()
                    .eq('id', requestId);

                if (error) throw error;

                await loadWithdrawRequests();
                showNotification('‚úÖ –ó–∞—è–≤–∫–∞ –Ω–∞ –≤—ã–≤–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞!');
            } catch (error) {
                console.error("‚ùå –û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞—è–≤–∫–∏:", error);
                showNotification('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∑–∞—è–≤–∫–∏!');
            }
        }

        // –ó–ê–î–ê–ù–ò–Ø
        function openQuests() {
            document.getElementById('questsModal').classList.add('active');
        }

        function closeQuests() {
            document.getElementById('questsModal').classList.remove('active');
        }

        async function claimQuest() {
            playerData.stars += 10;
            await savePlayerData();
            updateUI();
            showNotification('üéâ –í—ã –ø–æ–ª—É—á–∏–ª–∏ 10 –∑–≤—ë–∑–¥ –∑–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è!');
            closeQuests();
        }

        // –†–ï–§–ï–†–ê–õ–¨–ù–ê–Ø –°–ò–°–¢–ï–ú–ê
        function openReferral() {
            document.getElementById('referralModal').classList.add('active');
        }

        function closeReferral() {
            document.getElementById('referralModal').classList.remove('active');
        }

        // –ê–î–ú–ò–ù –ü–ê–ù–ï–õ–¨
        function toggleAdminPanel() {
            const panel = document.getElementById('adminPanel');
            panel.classList.toggle('active');
            if (panel.classList.contains('active')) {
                loadAllPlayers();
                loadWithdrawRequests();
            }
        }

        // –í–´–î–ê–ß–ê –ó–í–ï–ó–î –ò–ì–†–û–ö–£
        async function adminGiveStars() {
            const targetPlayerId = document.getElementById('adminPlayerId').value.trim();
            const stars = parseInt(document.getElementById('adminStars').value);

            if (!targetPlayerId || isNaN(stars)) {
                showNotification('‚ùå –ó–∞–ø–æ–ª–Ω–∏—Ç–µ ID –∏–≥—Ä–æ–∫–∞ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–≤—ë–∑–¥!');
                return;
            }

            if (stars <= 0) {
                showNotification('‚ùå –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–≤—ë–∑–¥ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –±–æ–ª—å—à–µ 0!');
                return;
            }

            try {
                // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ –∏–≥—Ä–æ–∫–∞
                const { data: playerData, error: fetchError } = await supabase
                    .from('players')
                    .select('stars')
                    .eq('id', targetPlayerId)
                    .single();

                if (fetchError) {
                    showNotification('‚ùå –ò–≥—Ä–æ–∫ —Å —Ç–∞–∫–∏–º ID –Ω–µ –Ω–∞–π–¥–µ–Ω!');
                    return;
                }

                // –û–±–Ω–æ–≤–ª—è–µ–º –∑–≤—ë–∑–¥—ã
                const newStars = (playerData.stars || 0) + stars;
                
                const { error: updateError } = await supabase
                    .from('players')
                    .update({ stars: newStars })
                    .eq('id', targetPlayerId);

                if (updateError) throw updateError;

                showNotification(`‚úÖ –í—ã–¥–∞–Ω–æ ${stars} –∑–≤—ë–∑–¥ –∏–≥—Ä–æ–∫—É ${targetPlayerId}`);
                
                // –ï—Å–ª–∏ –≤—ã–¥–∞–ª–∏ —Å–µ–±–µ, –æ–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
                if (targetPlayerId === playerData.id) {
                    playerData.stars = newStars;
                    updateUI();
                }

                // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤
                await loadAllPlayers();
                
            } catch (error) {
                console.error("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–¥–∞—á–µ –∑–≤—ë–∑–¥:", error);
                showNotification('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–¥–∞—á–µ –∑–≤—ë–∑–¥!');
            }
            
            document.getElementById('adminPlayerId').value = '';
            document.getElementById('adminStars').value = '';
        }

        async function adminReset() {
            if (confirm('–°–±—Ä–æ—Å–∏—Ç—å –≤–µ—Å—å –ø—Ä–æ–≥—Ä–µ—Å—Å?')) {
                try {
                    const { error } = await supabase
                        .from('players')
                        .delete()
                        .eq('id', playerData.id);

                    if (error) throw error;

                    localStorage.clear();
                    location.reload();
                } catch (error) {
                    console.error("‚ùå –û—à–∏–±–∫–∞ —Å–±—Ä–æ—Å–∞:", error);
                    localStorage.clear();
                    location.reload();
                }
            }
        }

        // –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò
        function showNotification(message) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // –ó–ê–ü–£–°–ö–ê–ï–ú –ò–ì–†–£ –ü–†–ò –ó–ê–ì–†–£–ó–ö–ï –°–¢–†–ê–ù–ò–¶–´
        window.onload = initGame;
    </script>
</body>
</html>
