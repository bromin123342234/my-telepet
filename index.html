<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ü•ö NFT Duck Eggs</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        /* –ë–ê–ó–û–í–´–ï –°–¢–ò–õ–ò */
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }
        body { 
            background: linear-gradient(135deg, #0F0F1E 0%, #0A0A15 100%); 
            min-height: 100vh; padding: 20px; color: #F8F9FA; 
            display: flex; justify-content: center; align-items: center; 
        }
        .game-container {
            background: rgba(26, 26, 46, 0.9); border-radius: 30px; padding: 35px 30px;
            max-width: 450px; width: 100%; text-align: center; border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .player-id { 
            position: absolute; top: 20px; left: 20px; background: gold; padding: 8px 16px;
            border-radius: 20px; font-size: 12px; font-weight: 700; color: black; 
        }
        .btn { 
            padding: 15px; border: none; border-radius: 15px; font-weight: 700; cursor: pointer;
            margin: 10px; width: 100%; color: white; font-size: 16px; 
        }
        .btn-primary { background: linear-gradient(135deg, #8B5FBF, #6B46C1); }
        .btn-secondary { background: linear-gradient(135deg, #FF6B6B, #FF4757); }
        .btn-admin { background: gold; color: black; display: none; }
        
        /* –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê */
        .modal { 
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(0,0,0,0.8); z-index: 1000; justify-content: center; align-items: center; 
        }
        .modal.active { display: flex; }
        .modal-content { 
            background: #1A1A2E; padding: 30px; border-radius: 20px; max-width: 400px; 
            width: 90%; text-align: center; border: 1px solid rgba(255,255,255,0.1);
        }
        .close-btn { 
            position: absolute; top: 15px; right: 15px; background: red; color: white;
            border: none; border-radius: 50%; width: 30px; height: 30px; cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="player-id">ID: <span id="playerId">–ó–∞–≥—Ä—É–∑–∫–∞...</span></div>
        
        <h1>ü¶Ü NFT Ducks</h1>
        
        <div class="egg-display">
            <div style="width: 120px; height: 120px; margin: 20px auto; border-radius: 50%; background: #333; display: flex; align-items: center; justify-content: center;">
                <span id="duckStatus">‚ùå</span>
            </div>
            <div id="eggTypeDisplay" style="background: #8B5FBF; color: white; padding: 10px 20px; border-radius: 20px; margin: 10px 0;">
                –ù–µ—Ç —É—Ç–∫–∏
            </div>
            <div id="deathMessage" style="color: red; display: none;">üíÄ –£—Ç–∫–∞ —É–º–µ—Ä–ª–∞!</div>
        </div>
        
        <div id="foodCount" style="background: #27AE60; color: white; padding: 10px 20px; border-radius: 20px; margin: 10px 0;">
            üçé –ï–¥—ã: 0
        </div>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 20px 0;">
            <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 15px;">
                <div>üçΩÔ∏è –°—ã—Ç–æ—Å—Ç—å</div>
                <div id="hungerValue">0/100</div>
            </div>
            <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 15px;">
                <div>üòä –ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ</div>
                <div id="moodValue">0/100</div>
            </div>
            <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 15px;">
                <div>‚≠ê –ó–≤—ë–∑–¥—ã</div>
                <div id="starsValue">0</div>
            </div>
            <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 15px;">
                <div>üéí –ü—Ä–µ–¥–º–µ—Ç—ã</div>
                <div id="itemsValue">0</div>
            </div>
        </div>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 20px 0;">
            <button class="btn btn-primary" onclick="feedDuck()">üçé –ü–æ–∫–æ—Ä–º–∏—Ç—å</button>
            <button class="btn btn-secondary" onclick="playWithDuck()">üéÆ –ü–æ–∏–≥—Ä–∞—Ç—å</button>
        </div>

        <button class="btn btn-admin" id="adminToggle" onclick="toggleAdminPanel()">üîß –ê–¥–º–∏–Ω –ü–∞–Ω–µ–ª—å</button>
        
        <div style="margin-top: 20px;">
            <button class="btn btn-primary" onclick="openShop()">üõí –ú–∞–≥–∞–∑–∏–Ω</button>
            <button class="btn btn-primary" onclick="openInventory()">üéí –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</button>
            <button class="btn btn-primary" onclick="openQuests()">üéØ –ó–∞–¥–∞–Ω–∏—è</button>
            <button class="btn btn-primary" onclick="openReferral()">üë• –†–µ—Ñ —Å–∏—Å—Ç–µ–º–∞</button>
        </div>

        <div id="adminPanel" style="display: none; margin-top: 20px; padding: 20px; background: rgba(255,255,255,0.1); border-radius: 15px;">
            <h3>üîß –ê–¥–º–∏–Ω –ü–∞–Ω–µ–ª—å</h3>
            <input type="text" id="adminPlayerId" placeholder="ID –∏–≥—Ä–æ–∫–∞" style="width: 100%; padding: 10px; margin: 5px 0; border-radius: 10px; border: 1px solid #ccc;">
            <input type="number" id="adminStars" placeholder="–ó–≤—ë–∑–¥—ã" style="width: 100%; padding: 10px; margin: 5px 0; border-radius: 10px; border: 1px solid #ccc;">
            <button class="btn btn-primary" onclick="adminGiveStars()">‚úÖ –í—ã–¥–∞—Ç—å –∑–≤—ë–∑–¥—ã</button>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê -->
    <div class="modal" id="shopModal">
        <div class="modal-content">
            <button class="close-btn" onclick="closeShop()">√ó</button>
            <h2>üõí –ú–∞–≥–∞–∑–∏–Ω</h2>
            
            <div style="background: rgba(255,255,255,0.1); padding: 15px; margin: 10px 0; border-radius: 15px;">
                <div><strong>‚ú® –ó–æ–ª–æ—Ç–∞—è —É—Ç–∫–∞ - 300 ‚≠ê</strong></div>
                <button class="btn btn-primary" onclick="buyItem('gold_egg', 300)">–ö—É–ø–∏—Ç—å</button>
            </div>
            
            <div style="background: rgba(255,255,255,0.1); padding: 15px; margin: 10px 0; border-radius: 15px;">
                <div><strong>üçé –ï–¥–∞ (3 —à—Ç) - 15 ‚≠ê</strong></div>
                <button class="btn btn-primary" onclick="buyItem('food', 15)">–ö—É–ø–∏—Ç—å</button>
            </div>
            
            <div style="background: rgba(255,255,255,0.1); padding: 15px; margin: 10px 0; border-radius: 15px;">
                <div><strong>ü¶Ü –û–±—ã—á–Ω–∞—è —É—Ç–∫–∞ - 50 ‚≠ê</strong></div>
                <button class="btn btn-primary" onclick="buyItem('normal_egg', 50)">–ö—É–ø–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <div class="modal" id="confirmModal">
        <div class="modal-content">
            <h3>–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ</h3>
            <p id="confirmText">–í—ã —É–≤–µ—Ä–µ–Ω—ã?</p>
            <button class="btn btn-secondary" onclick="closeConfirm()">–û—Ç–º–µ–Ω–∞</button>
            <button class="btn btn-primary" onclick="confirmPurchase()">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
        </div>
    </div>

    <div class="modal" id="inventoryModal">
        <div class="modal-content">
            <button class="close-btn" onclick="closeInventory()">√ó</button>
            <h2>üéí –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</h2>
            <div id="inventoryItems">–ü—É—Å—Ç–æ</div>
        </div>
    </div>

    <div class="modal" id="withdrawModal">
        <div class="modal-content">
            <button class="close-btn" onclick="closeWithdraw()">√ó</button>
            <h2>üì§ –í—ã–≤–æ–¥</h2>
            <p>–ü—Ä–µ–¥–º–µ—Ç: <strong id="withdrawItemName"></strong></p>
            <input type="text" id="telegramUsername" placeholder="@username" style="width: 100%; padding: 10px; margin: 10px 0; border-radius: 10px;">
            <button class="btn btn-primary" onclick="submitWithdraw()">‚úÖ –û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
        </div>
    </div>

    <div class="modal" id="questsModal">
        <div class="modal-content">
            <button class="close-btn" onclick="closeQuests()">√ó</button>
            <h2>üéØ –ó–∞–¥–∞–Ω–∏—è</h2>
            <div style="background: rgba(255,255,255,0.1); padding: 15px; margin: 10px 0; border-radius: 15px;">
                <strong>üì¢ –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∫–∞–Ω–∞–ª</strong>
                <p>–ü–æ–¥–ø–∏—à–∏—Ç–µ—Å—å –Ω–∞ @MyNFTPet</p>
                <button class="btn btn-primary" onclick="openTelegram()">üîó –ü–µ—Ä–µ–π—Ç–∏</button>
                <button class="btn btn-primary" onclick="claimQuest()">üéÅ –ü–æ–ª—É—á–∏—Ç—å 10‚≠ê</button>
            </div>
        </div>
    </div>

    <div class="modal" id="referralModal">
        <div class="modal-content">
            <button class="close-btn" onclick="closeReferral()">√ó</button>
            <h2>üë• –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞</h2>
            <p style="color: orange;">‚ö†Ô∏è –í—Ä–µ–º–µ–Ω–Ω–æ –∑–∞–∫—Ä—ã—Ç–∞</p>
        </div>
    </div>

    <script>
        // –ü–†–û–°–¢–´–ï –î–ê–ù–ù–´–ï –ò–ì–†–û–ö–ê
        let playerData = {
            id: '',
            hunger: 0,
            mood: 0,
            stars: 0,
            items: [],
            currentEgg: null,
            foodCount: 0,
            isAlive: false
        };

        let currentPurchase = null;
        let currentWithdrawItem = null;

        // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ò–ì–†–´
        function initGame() {
            console.log("–ò–≥—Ä–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...");
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º ID
            playerData.id = 'USER_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
            document.getElementById('playerId').textContent = playerData.id;
            
            // –î–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—É—é –µ–¥—É
            playerData.foodCount = 3;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–¥–º–∏–Ω–∞
            if (playerData.id === "USER_1761399526979_swpx4n20o") {
                document.getElementById('adminToggle').style.display = 'block';
            }
            
            updateUI();
            showNotification('üéâ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!');
        }

        // –û–ë–ù–û–í–õ–ï–ù–ò–ï –ò–ù–¢–ï–†–§–ï–ô–°–ê
        function updateUI() {
            document.getElementById('hungerValue').textContent = playerData.hunger + '/100';
            document.getElementById('moodValue').textContent = playerData.mood + '/100';
            document.getElementById('starsValue').textContent = playerData.stars;
            document.getElementById('itemsValue').textContent = playerData.items.length;
            document.getElementById('foodCount').textContent = 'üçé –ï–¥—ã: ' + playerData.foodCount;

            if (!playerData.isAlive) {
                document.getElementById('duckStatus').textContent = 'üíÄ';
                document.getElementById('eggTypeDisplay').textContent = '–£—Ç–∫–∞ —É–º–µ—Ä–ª–∞';
                document.getElementById('deathMessage').style.display = 'block';
            } else if (playerData.currentEgg) {
                document.getElementById('duckStatus').textContent = 'ü•ö';
                document.getElementById('eggTypeDisplay').textContent = playerData.currentEgg.type === 'gold_egg' ? '‚ú® –ó–æ–ª–æ—Ç–∞—è —É—Ç–∫–∞' : 'ü¶Ü –û–±—ã—á–Ω–∞—è —É—Ç–∫–∞';
                document.getElementById('deathMessage').style.display = 'none';
            } else {
                document.getElementById('duckStatus').textContent = '‚ùå';
                document.getElementById('eggTypeDisplay').textContent = '–ù–µ—Ç —É—Ç–∫–∏';
                document.getElementById('deathMessage').style.display = 'none';
            }
        }

        // –£–•–û–î –ó–ê –£–¢–ö–û–ô
        function feedDuck() {
            console.log("–ö–æ—Ä–º–ª–µ–Ω–∏–µ —É—Ç–∫–∏...");
            if (!playerData.isAlive) {
                showNotification('‚ùå –£—Ç–∫–∞ —É–º–µ—Ä–ª–∞! –ö—É–ø–∏—Ç–µ –Ω–æ–≤—É—é.');
                return;
            }
            if (playerData.foodCount <= 0) {
                showNotification('‚ùå –ù–µ—Ç –µ–¥—ã!');
                return;
            }
            playerData.hunger = Math.min(100, playerData.hunger + 14);
            playerData.foodCount--;
            updateUI();
            showNotification('üçé +14 –∫ —Å—ã—Ç–æ—Å—Ç–∏');
            checkDeath();
        }

        function playWithDuck() {
            console.log("–ò–≥—Ä–∞ —Å —É—Ç–∫–æ–π...");
            if (!playerData.isAlive) {
                showNotification('‚ùå –£—Ç–∫–∞ —É–º–µ—Ä–ª–∞!');
                return;
            }
            playerData.mood = Math.min(100, playerData.mood + 10);
            updateUI();
            showNotification('üéÆ +10 –∫ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—é');
        }

        function checkDeath() {
            if ((playerData.hunger <= 0 || playerData.mood <= 0) && playerData.isAlive) {
                playerData.isAlive = false;
                playerData.currentEgg = null;
                updateUI();
                showNotification('üíÄ –£—Ç–∫–∞ —É–º–µ—Ä–ª–∞!');
            }
        }

        // –ú–ê–ì–ê–ó–ò–ù
        function openShop() {
            console.log("–û—Ç–∫—Ä—ã–≤–∞–µ–º –º–∞–≥–∞–∑–∏–Ω...");
            document.getElementById('shopModal').classList.add('active');
        }

        function closeShop() {
            document.getElementById('shopModal').classList.remove('active');
        }

        function buyItem(itemType, cost) {
            console.log("–ü–æ–∫—É–ø–∞–µ–º:", itemType);
            currentPurchase = { itemType, cost };
            document.getElementById('confirmText').textContent = `–ö—É–ø–∏—Ç—å –∑–∞ ${cost}‚≠ê?`;
            document.getElementById('confirmModal').classList.add('active');
        }

        function closeConfirm() {
            document.getElementById('confirmModal').classList.remove('active');
        }

        function confirmPurchase() {
            if (!currentPurchase) return;
            
            const { itemType, cost } = currentPurchase;
            
            if (playerData.stars < cost) {
                showNotification('‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–≤—ë–∑–¥!');
                closeConfirm();
                return;
            }
            
            playerData.stars -= cost;
            
            if (itemType === 'food') {
                playerData.foodCount += 3;
                showNotification('üéâ –ö—É–ø–ª–µ–Ω–æ 3 –µ–¥—ã!');
            } else {
                // –ü–æ–∫—É–ø–∞–µ–º —É—Ç–∫—É
                playerData.currentEgg = { type: itemType };
                playerData.isAlive = true;
                playerData.hunger = 100;
                playerData.mood = 100;
                showNotification('üéâ –ö—É–ø–ª–µ–Ω–∞ —É—Ç–∫–∞!');
            }
            
            updateUI();
            closeConfirm();
            closeShop();
        }

        // –ò–ù–í–ï–ù–¢–ê–†–¨ –ò –í–´–í–û–î
        function openInventory() {
            console.log("–û—Ç–∫—Ä—ã–≤–∞–µ–º –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å...");
            const itemsDiv = document.getElementById('inventoryItems');
            
            if (playerData.items.length === 0) {
                itemsDiv.innerHTML = '<p>–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –ø—É—Å—Ç</p>';
            } else {
                let html = '';
                playerData.items.forEach((item, index) => {
                    html += `<div style="background: rgba(255,255,255,0.1); padding: 10px; margin: 5px 0; border-radius: 10px;">
                        ${item.name} <button onclick="startWithdraw(${index})" style="background: #27AE60; color: white; border: none; padding: 5px 10px; border-radius: 5px; margin-left: 10px;">–í—ã–≤–æ–¥</button>
                    </div>`;
                });
                itemsDiv.innerHTML = html;
            }
            
            document.getElementById('inventoryModal').classList.add('active');
        }

        function closeInventory() {
            document.getElementById('inventoryModal').classList.remove('active');
        }

        function startWithdraw(itemIndex) {
            currentWithdrawItem = itemIndex;
            const item = playerData.items[itemIndex];
            document.getElementById('withdrawItemName').textContent = item.name;
            document.getElementById('withdrawModal').classList.add('active');
        }

        function closeWithdraw() {
            document.getElementById('withdrawModal').classList.remove('active');
        }

        function submitWithdraw() {
            const telegram = document.getElementById('telegramUsername').value;
            if (!telegram) {
                showNotification('‚ùå –í–≤–µ–¥–∏—Ç–µ Telegram!');
                return;
            }
            
            // –£–¥–∞–ª—è–µ–º –ø—Ä–µ–¥–º–µ—Ç –∏–∑ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
            playerData.items.splice(currentWithdrawItem, 1);
            updateUI();
            closeWithdraw();
            closeInventory();
            showNotification('‚úÖ –ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞!');
        }

        // –ó–ê–î–ê–ù–ò–Ø
        function openQuests() {
            console.log("–û—Ç–∫—Ä—ã–≤–∞–µ–º –∑–∞–¥–∞–Ω–∏—è...");
            document.getElementById('questsModal').classList.add('active');
        }

        function closeQuests() {
            document.getElementById('questsModal').classList.remove('active');
        }

        function openTelegram() {
            window.open('https://t.me/MyNFTPet', '_blank');
        }

        function claimQuest() {
            playerData.stars += 10;
            updateUI();
            showNotification('üéâ –ü–æ–ª—É—á–µ–Ω–æ 10 –∑–≤—ë–∑–¥!');
            closeQuests();
        }

        // –†–ï–§–ï–†–ê–õ–¨–ù–ê–Ø –°–ò–°–¢–ï–ú–ê
        function openReferral() {
            console.log("–û—Ç–∫—Ä—ã–≤–∞–µ–º —Ä–µ—Ñ —Å–∏—Å—Ç–µ–º—É...");
            document.getElementById('referralModal').classList.add('active');
        }

        function closeReferral() {
            document.getElementById('referralModal').classList.remove('active');
        }

        // –ê–î–ú–ò–ù –ü–ê–ù–ï–õ–¨
        function toggleAdminPanel() {
            const panel = document.getElementById('adminPanel');
            panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
        }

        function adminGiveStars() {
            const playerId = document.getElementById('adminPlayerId').value;
            const stars = parseInt(document.getElementById('adminStars').value);
            
            if (!playerId || isNaN(stars)) {
                showNotification('‚ùå –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–æ–ª—è!');
                return;
            }
            
            if (playerId === playerData.id) {
                playerData.stars += stars;
                updateUI();
            }
            
            showNotification(`‚úÖ –í—ã–¥–∞–Ω–æ ${stars} –∑–≤—ë–∑–¥ –∏–≥—Ä–æ–∫—É ${playerId}`);
            document.getElementById('adminPlayerId').value = '';
            document.getElementById('adminStars').value = '';
        }

        // –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò
        function showNotification(message) {
            alert(message); // –ü—Ä–æ—Å—Ç–æ–π alert –≤–º–µ—Å—Ç–æ —Å–ª–æ–∂–Ω–æ–≥–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        }

        // –ó–ê–ü–£–°–ö–ê–ï–ú –ò–ì–†–£ –ü–†–ò –ó–ê–ì–†–£–ó–ö–ï
        window.onload = initGame;
    </script>
</body>
</html>
